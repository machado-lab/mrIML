#'mrInteractions:  Wrapper to calculate and plot summed interactions of features across response variables. Bases on Greenwell et al 2018 
#.
#'@param yhats A \code{list} is the list generated by mrIMLpredicts
#'@param X A \code{dataframe} is a response variable data set (species, OTUs, SNPs etc)
#'@param Y  A \code{dataframe} #is the feature dataset
#'@param Model 1 A \code{list} can be any model from the tidy model package. See examples.
#'@param 'Feature' \code{character} Feature from the Y set to plot the partial dependency.
#'
#'@details The aim of this function is to enable users to calculate partial dependencies for the response variables for each model (i.e. species/SNPs)
#' and then use plot_mrpd (a plotting function) to create a pd plot for all species/SNPs for each feature. 
#' Could build functionality for ICE plots but that would be messy for multiple repsonse variables.
#' 
#' @example 
#' testPdp <- mrPdP(yhats, model1,X=X,Y=Y)


mrInteractions <- function(yhats, X, Y){
  
  l_response<- length(yhats)
  n_features <- names(Y)
  n_response <- names(X)
  
  #unpack everything from yhats
  tList <- yhats %>% purrr::map(pluck('data_train')) #get together training data.
  modList <- yhats %>% purrr::map(pluck('mod1_k'))
  dataAll <- yhats %>% purrr::map(pluck('data'))
  fitList <- yhats %>% purrr::map(pluck('last_mod_fit'))
  
  imInt <- lapply(seq(1:l_response), function(i){ #uses monte carlo CV
    imp <- modList[[i]] %>% 
     vintTidy(feature_names = n_features, train = dataAll[[i]])
    #modified vint function - very slow over171 combinations
    
    impD <- imp$Interaction
    
    #var <-impD %>%
     # purrr::pluck("Variables")
    
  })
  
  ImpGlobal <- do.call(cbind, imInt) 
  #ImpGlobalnames <- cbind(ImpGlobal, var)
}